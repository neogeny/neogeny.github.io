jQuery.fn.movePageHistory=function(B){var E=jQuery;var C=E("#confluence-context-path").attr("content");var A=this;var D=E(".search-results",A);E(D).keydown(function(G){function F(K){var I=E(".search-result",A);var J=E(".search-result.selected",A);var H=I.index(J)+K;if(H<0){H=I.length-1}if(H>=I.length){H=0}I.eq(H).click()}if(G.which==38){F(-1)}else{if(G.which==40){F(1)}}});D.html(AJS.getTemplate("movePageHistoryLoading").toString());E.ajax({type:"GET",dataType:"json",data:{types:["spacedesc","personalspacedesc","page"]},url:C+"/json/history.action",error:function(){B.error(AJS.params.movePageDialogHistoryError)},success:function(G,F){if(F!="success"){B.error(AJS.params.movePageDialogHistoryError);return }if(!G.history||G.history.length==0){D.html("<div class='no-results'>"+AJS.params.movePageDialogHistoryNoResults+"</div>");return }D.html(AJS.getTemplate("searchResultsGrid").toString());E.each(G.history,function(){var I=this;if(I.id==AJS.params.pageId){return }var H=AJS.$(AJS.renderTemplate("searchResultsGridRow",[I.title,C+I.url,I.type,I.spaceName,I.spaceKey,I.friendlyDate,I.date]));E(H).click(function(J){if(I.type=="page"){B.select(I.spaceKey,I.spaceName,I.title,I.id)}else{B.select(I.spaceKey,I.spaceName)}D.find(".selected").removeClass("selected");E(this).addClass("selected");return AJS.stopEvent(J)});E(H).hover(function(){E(this).addClass("hover")},function(){E(this).removeClass("hover")});D.find("table").append(H)});if(E(".search-result",D).length==0){D.html("<div class='no-results'>"+AJS.params.movePageDialogHistoryNoResults+"</div>")}}})};