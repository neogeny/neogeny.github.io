AJS.Confluence.Binder.autocompleteUser=function(){var B=AJS.$;var A=function(D){if(!D||!D.result){throw new Error("Invalid JSON format")}var C=[];C.push(D.result);return C};B("input.autocomplete-user[data-processed!=true]").each(function(){var E=B(this).attr("data-processed","true").attr("autocomplete","off");var D=E.attr("data-max")||10,G=E.attr("data-alignment")||"left",F=E.attr("data-dropdown-target"),C=null;if(F){C=B(F)}else{C=B("<div></div>");E.after(C)}C.addClass("aui-dd-parent autocomplete");E.quicksearch(AJS.REST.getBaseUrl()+"search/user.json",function(){E.trigger("open.autocomplete-user")},{makeParams:function(H){return{"max-results":D,query:H}},dropdownPlacement:function(H){C.append(H)},makeRestMatrixFromData:A,addDropdownData:function(H){if(!H.length){var I=E.attr("data-none-message");if(I){H.push([{name:I,className:"no-results",href:"#"}])}}return H},ajsDropDownOptions:{alignment:G,displayHandler:function(H){if(H.restObj&&H.restObj.username){return H.name+" ("+H.restObj.username+")"}return H.name},selectionHandler:function(M,J){if(J.hasClass("search-for")){E.trigger("selected.autocomplete-user",{searchFor:E.val()});return }if(J.hasClass("no-results")){this.hide();M.preventDefault();return }var H=B("span:eq(0)",J).data("properties"),N=H.restObj.username,K=E.attr("data-target"),L=K&&B(K),I=E.attr("data-template")||"{username}";E.val(AJS.template(I).fillHtml(H.restObj));L&&L.val(N);E.trigger("selected.autocomplete-user",{content:H.restObj});this.hide();M.preventDefault()}}})})};