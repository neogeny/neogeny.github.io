AJS.Confluence.Binder.comments=function(){var C=AJS.$;if(C(window).data("comments-bound")){AJS.log("Currently, this comment binding can only be done once per page");return }var B=function(J){var H=function(L,K){return{animate:function(M){L.style.height=AJS.animation.interpolate(M,48,24,K)+"px";L.style.width=L.style.height;L.style.marginLeft=AJS.animation.interpolate(M,0,12,K)+"px"},onFinish:function(){L.style.height="";L.style.width="";L.style.marginLeft=""}}};var F=function(L,K){return{start:1,end:0,reverse:K,animate:function(M){L.style.opacity=M;L.style.filter="alpha(opacity="+(M*100)+")"},onFinish:function(){L.style.opacity="";L.style.filter="alpha(opacity="+(K?100:0)+")"}}};var I=function(L,K){if(!K){L.originalHeight=jQuery(L).height()}return{start:L.originalHeight||50,end:0,reverse:K,animate:function(M){L.style.height=M+"px"},onFinish:function(){L.style.height=""}}};var E=jQuery(J).find(".comment-body")[0];var G=J.className.indexOf("collapsed")>=0;return AJS.animation.combine([H(jQuery(J).parent().find(".comment-user-logo img, .comment-user-logo .replacement")[0],G),F(E,G),F(jQuery(J).find(".excerpt")[0],!G),I(E,G),{onFinish:function(){if(G){jQuery(J).removeClass("collapsed")}else{jQuery(J).addClass("collapsed")}}}])};var D=function(){var E=this;C(E).unbind("click");AJS.animation.add(B(C(E).parent()[0]));AJS.animation.add({onFinish:function(){C(E).click(D)}});AJS.animation.start()};if(AJS.isIE6){C(".logo.anonymous").each(function(){var E=document.createElement("div");E.className="replacement";AJS.applyPngFilter(E,this.src);C(this).replaceWith(E)});C(".comment-actions .comment-permalink a").each(function(){C(this).addClass("filtered");var F=C(this).css("background-image").replace(/^url\(\"?|\"?\)$/g,"");var E=F.replace("light","dark");AJS.applyPngFilter(this,F);this.style.cursor="pointer";this.style.background="none";C(this).hover(function(){AJS.applyPngFilter(this,E)},function(){AJS.applyPngFilter(this,F)})})}C("#comments-section .comment:odd").addClass("odd");C(".comment-action-remove a").click(function(){if(confirm(AJS.params.deleteCommentConfirmMessage)){this.href=this.href+"&confirm=yes";return true}return false});C("#comments-hide").click(function(){C("#page-comments").addClass("hidden");C(this).addClass("hidden");C("#comments-show").removeClass("hidden");C("#comments-expand-collapse").addClass("hidden");return false});C("#comments-show").click(function(){C("#page-comments").removeClass("hidden");C(this).addClass("hidden");C("#comments-hide").removeClass("hidden");C("#comments-expand-collapse").removeClass("hidden");return false});C("#comments-collapse").click(function(){C(this).addClass("hidden");C("#collapse-wait").removeClass("hidden");C(".comment:lt(10):not(.collapsed,.add,.reply,.edit)").each(function(){AJS.animation.add(B(this))});AJS.animation.add({onFinish:function(){C("#collapse-wait").addClass("hidden");C("#comments-expand").removeClass("hidden");C(".comment:not(.add,.reply,.edit)").addClass("collapsed")}});AJS.animation.start();return false});C("#comments-expand").click(function(){C(this).addClass("hidden");C("#expand-wait").removeClass("hidden");C(".comment:lt(10).collapsed").each(function(){AJS.animation.add(B(this))});AJS.animation.add({onFinish:function(){C("#expand-wait").addClass("hidden");C("#comments-collapse").removeClass("hidden");C(".comment").removeClass("collapsed")}});AJS.animation.start();return false});var A=C(".comment-toggle");if(A.length){A.css("cursor","pointer").attr("title",AJS.params.collapseTooltip).click(D)}C(window).data("comments-bound","true")};