jQuery.fn.movePageSearch=function(B){var H=jQuery;var C=H("#confluence-context-path").attr("content");var A=this;var E=H("input[type=button]",A);var G=H("input.search-query",A);var F=H(".search-space",A);var D=H(".search-results",A);H([F[0],G[0]]).keydown(function(I){if(I.which==13){E.click()}});H([G[0],D[0]]).keydown(function(J){function I(N){var L=H(".search-result",A);var M=H(".search-result.selected",A);var K=L.index(M)+N;if(K<0){K=L.length-1}if(K>=L.length){K=0}L.eq(K).click()}if(J.which==38){I(-1)}else{if(J.which==40){I(1)}}});E.click(function(){B.clearErrors();var I=G.val();if(I==""){D.empty();return }D.html(AJS.getTemplate("movePageSearchResultsLoading").toString());H.ajax({type:"GET",dataType:"json",data:{queryString:I,where:F.val(),types:["spacedesc","personalspacedesc","page"]},url:C+"/json/search.action",error:function(){B.error(AJS.params.movePageDialogSearchError)},success:function(K,J){if(J!="success"){B.error(AJS.params.movePageDialogSearchError);return }var L={select:function(M,N){if(N.type=="page"){B.select(N.spaceKey,N.spaceName,N.title,N.id)}else{B.select(N.spaceKey,N.spaceName)}}};D.searchResultsGrid(I,K,H(B).extend(L),{noSearchResults:AJS.params.movePageDialogSearchNoResults,resultsCount:AJS.params.movePageDialogSearchResultCount})}})})};