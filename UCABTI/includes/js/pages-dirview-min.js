(function(C){var D=function(E){AJS.$(E).slideUp(function(){AJS.$(E).remove()})};var B=function(G,F,E){C.getJSON(AJS.params.contextPath+"/pages/movepage.action",{pageId:G,position:E,targetId:F},A)};var A=function(F){var E="";if(F.actionErrors&&F.actionErrors.length){E=F.actionErrors.join("<br>");AJS.log("ajax parameters invalid : "+E)}C("#resultsDiv").html(E)};AJS.toInit(function(F){var E=F("#tree-div").tree({url:AJS.params.contextPath+"/pages/children.action",initUrl:AJS.params.contextPath+"/pages/children.action?spaceKey="+encodeURIComponent(AJS.params.spaceKey)+"&node=root",parameters:["pageId"],nodeId:"pageId",drop:function(){function H(){if(arguments.length==1&&arguments[0][0]=="#"){var I=arguments[0].substring(1,7);if(I.length==3){I=I[0]+I[0]+I[1]+I[1]+I[2]+I[2]}this.R=parseInt(I.substring(0,2),16);this.G=parseInt(I.substring(2,4),16);this.B=parseInt(I.substring(4),16)}else{if(arguments.length==3){this.R=parseInt(arguments[0],10);this.G=parseInt(arguments[1],10);this.B=parseInt(arguments[2],10)}else{return false}}this.toString=function(){return"#"+this.R.toString(16)+this.G.toString(16)+this.B.toString(16)}}var G=function(L){var I=new H("#d8e4f1"),N=new H("#fff"),O=I.R,P=N.R-I.R,Q=I.G,K=N.G-I.G,J=I.B,M=N.B-I.B;return{start:0,end:1,animate:function(R){L.style.backgroundColor=new H(O+P*R,Q+K*R,J+M*R)},onFinish:function(){L.style.backgroundColor=""}}};AJS.animation.add(G(this.source));AJS.animation.duration=500;AJS.animation.start();B(this.source.pageId,this.target.pageId,this.position)},order:function(){var G=this.source.pageId;F.getJSON(AJS.params.contextPath+"/pages/revertpageorder.action",{pageId:G},A)},orderUndo:function(){var G=this.source.pageId;var H=jQuery.map(this.orderedChildren,function(I){return I.pageId}).join();F.getJSON(AJS.params.contextPath+"/pages/setpageorder.action",{pageId:G,orderedChildIds:H},A)},onready:function(){if(!AJS.params.expandedNodes){AJS.params.expandedNodes=[]}if(AJS.params.openId){var J=function(){E.findNodeBy("pageId",AJS.params.openId).highlight()}}var G=[];for(var H=0,I=AJS.params.expandedNodes.length;H<I;H++){G[H]={pageId:AJS.params.expandedNodes[H]}}E.expandPath(G.reverse(),J)}})})})(AJS.$);