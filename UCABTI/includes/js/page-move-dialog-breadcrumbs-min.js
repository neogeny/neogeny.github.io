jQuery.fn.shortenUntil=function(D){var B=jQuery;var C=0;while(!D()&&C<this.length){var A=B(this[C]).text();if(A=="\u2026"){C++;continue}B(this[C]).text(A.replace(/[^\u2026]\u2026?$/,"\u2026"))}return this};jQuery.fn.renderBreadcrumbs=function(I){var F=jQuery,D=this,H=[],G=0,K=I.length-1;var A=I[G];var B=A.url.indexOf("~")>=0?"personalspacedesc":"spacedesc";H.push(AJS.renderTemplate("movePageBreadcrumb",A.title,A.url,(G==K?"last content-type-"+B:""),A.title));while(G++<K){var J=I[G];H.push(AJS.renderTemplate("movePageBreadcrumb",J.title,J.url,(G==K?"last content-type-"+I.type:""),J.title))}var E=function(){return D.width()<D.closest(".breadcrumbs-container").width()};this.html(H.join(""));var C=F("li a span",this);C.each(function(L){if(L!=0&&L!=K){F(this).shortenUntil(E)}});F(C.get(0)).shortenUntil(E);F(C.get(K)).shortenUntil(E);return this};AJS.toInit(function(D){var B=D("#confluence-context-path").attr("content");function A(E){for(var F=1;F<E.length;F++){if(E[F].title==AJS.params.pageTitle){return false}}return true}if(!AJS.MoveDialog){AJS.MoveDialog={}}var C={};AJS.MoveDialog.getBreadcrumbs=function(F,H,E){var G=F.userName?F.userName:(F.pageId?(F.pageId+":"+F.fileName):(F.spaceKey+":"+F.title+":"+F.postingDay+":"+F.fileName));if(G in C){H(C[G],"success");return }D.ajax({type:"GET",dataType:"json",data:F,url:B+"/pages/breadcrumb.action",error:E||function(){},success:function(J,K){if(!J||!J.breadcrumbs){E(J,K);return }var I=D.makeArray(J.breadcrumbs);while(I[0]&&(/dashboard.action$/.test(I[0].url)||(J.type!="userinfo"&&/peopledirectory.action$/.test(I[0].url)))){I.shift()}I.type=J.type;C[G]=I;H(I,K)}})};AJS.MoveDialog.Breadcrumbs=function(G){var E=0;function F(K,J,I){G.renderBreadcrumbs(J);var H=K!=AJS.params.spaceKey||A(J);if(H){I.clearErrors();D(I.moveButton).attr("disabled","")}else{I.error(AJS.params.movePageDialogInvalidLocation);D("li:last-child",G).addClass("warning")}}return{update:function(I,H){G.html(AJS.renderTemplate("movePageBreadcrumbLoading"));var J=E+=1;var K=function(){if(J!=E){AJS.log("Breadcrumb response for ");AJS.log(I);AJS.log(" is stale, ignoring.");return true}return false};AJS.MoveDialog.getBreadcrumbs(I,function(L,M){if(K()){return }if(M!="success"||!L){G.html(AJS.renderTemplate("movePageBreadcrumbError",M));return }F(I.spaceKey,L,H)},function(L){if(K()){return }G.html(AJS.renderTemplate("movePageBreadcrumbError"));if(L.status==404){H.error(AJS.params.movePageDialogLocationNotFound)}})}}}});